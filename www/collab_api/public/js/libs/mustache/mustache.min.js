var Mustache=function(){var o=function(){};o.prototype={otag:"{{",ctag:"}}",pragmas:{},buffer:[],pragmas_implemented:{"IMPLICIT-ITERATOR":true,"TRANSLATION-HINT":true},context:{},render:function(a,b,c,d){if(!d){this.context=b;this.buffer=[]}if(!this.includes("",a)){if(d){return a}else{this.send(a);return}}if(this.pragmas['TRANSLATION-HINT']){b['_mode']=this.pragmas['TRANSLATION-HINT']['mode']}a=this.render_pragmas(a);a=this.render_i18n(a,b,c);var e=this.render_section(a,b,c);if(e===a){if(d){return this.render_tags(e,b,c,true)}this.render_tags(e,b,c,false)}else{if(d){return e}else{var f=e.split("\n");for(var i=0;i<f.length;i++){this.send(f[i])}return}}},send:function(a){if(a!=""){this.buffer.push(a)}},render_pragmas:function(e){if(!this.includes("%",e)){return e}var f=this;var g=new RegExp(this.otag+"%([\\w-]+) ?([\\w]+=[\\w]+)?"+this.ctag);return e.replace(g,function(a,b,c){if(!f.pragmas_implemented[b]){throw({message:"This implementation of mustache doesn't understand the '"+b+"' pragma"})}f.pragmas[b]={};if(c){var d=c.split("=");f.pragmas[b][d[0]]=d[1]}return""})},render_partial:function(a,b,c){a=this.trim(a);if(!c||c[a]===undefined){throw({message:"unknown_partial '"+a+"'"})}if(typeof(b[a])!="object"){return this.render(c[a],b,c,true)}return this.render(c[a],b[a],c,true)},render_i18n:function(d,e,f){if(d.indexOf(this.otag+"_i")==-1){return d}var g=this;var h=new RegExp(this.otag+"\\_i"+this.ctag+"\\s*([\\s\\S]+?)"+this.otag+"\\/i"+this.ctag,"mg");return d.replace(h,function(a,b){var c=undefined;if(g.pragmas&&g.pragmas["TRANSLATION-HINT"]&&g.pragmas["TRANSLATION-HINT"]['mode']){c={_mode:g.pragmas["TRANSLATION-HINT"]['mode']}}else if(e['_mode']){c={_mode:e['_mode']}}return g.render(_(b,c),e,f,true)})},render_section:function(j,k,l){if(!this.includes("#",j)&&!this.includes("^",j)){return j}var m=this;var n=new RegExp("^([\\s\\S]*?)"+this.otag+"(\\^|\\#)\\s*(.+)\\s*"+this.ctag+"\n*([\\s\\S]*?)"+this.otag+"\\/\\s*\\3\\s*"+this.ctag+"\\s*([\\s\\S]*)$","g");return j.replace(n,function(b,c,d,e,f,g){var h=c?m.render_tags(c,k,l,true):"",renderedAfter=g?m.render(g,k,l,true):"";var i=m.find(e,k);if(d=="^"){if(!i||m.is_array(i)&&i.length===0){return h+m.render(f,k,l,true)+renderedAfter}else{return h+""+renderedAfter}}else if(d=="#"){if(m.is_array(i)){return h+m.map(i,function(a){return m.render(f,m.create_context(a),l,true)}).join("")+renderedAfter}else if(m.is_object(i)){return h+m.render(f,m.create_context(i),l,true)+renderedAfter}else if(typeof i==="function"){return h+i.call(k,f,function(a){return m.render(a,k,l,true)})+renderedAfter}else if(i){return h+m.render(f,k,l,true)+renderedAfter}else{return h+""+renderedAfter}}})},render_tags:function(d,e,f,g){var h=this;var j=function(){return new RegExp(h.otag+"(=|!|>|\\{|%)?([^\\/#\\^]+?)\\1?"+h.ctag+"+","g")};var k=j();var l=function(a,b,c){switch(b){case"!":return"";case"=":h.set_delimiters(c);k=j();return"";case">":return h.render_partial(c,e,f);case"{":return h.find(c,e);default:return h.escape(h.find(c,e))}};var m=d.split("\n");for(var i=0;i<m.length;i++){m[i]=m[i].replace(k,l,this);if(!g){this.send(m[i])}}if(g){return m.join("\n")}},set_delimiters:function(a){var b=a.split(" ");this.otag=this.escape_regex(b[0]);this.ctag=this.escape_regex(b[1])},escape_regex:function(a){if(!arguments.callee.sRE){var b=['/','.','*','+','?','|','(',')','[',']','{','}','\\'];arguments.callee.sRE=new RegExp('(\\'+b.join('|\\')+')','g')}return a.replace(arguments.callee.sRE,'\\$1')},find:function(b,c){b=this.trim(b);function is_kinda_truthy(a){return a===false||a===0||a}var d;if(is_kinda_truthy(c[b])){d=c[b]}else if(is_kinda_truthy(this.context[b])){d=this.context[b]}if(typeof d==="function"){return d.apply(c)}if(d!==undefined){return d}return""},includes:function(a,b){return b.indexOf(this.otag+a)!=-1},escape:function(s){s=String(s===null?"":s);return s.replace(/&(?!\w+;)|["'<>\\]/g,function(s){switch(s){case"&":return"&amp;";case"\\":return"\\\\";case'"':return'&quot;';case"'":return'&#39;';case"<":return"&lt;";case">":return"&gt;";default:return s}})},create_context:function(a){if(this.is_object(a)){return a}else{var b=".";if(this.pragmas["IMPLICIT-ITERATOR"]){b=this.pragmas["IMPLICIT-ITERATOR"].iterator}var c={};c[b]=a;return c}},is_object:function(a){return a&&typeof a=="object"},is_array:function(a){return Object.prototype.toString.call(a)==='[object Array]'},trim:function(s){return s.replace(/^\s*|\s*$/g,"")},map:function(a,b){if(typeof a.map=="function"){return a.map(b)}else{var r=[];var l=a.length;for(var i=0;i<l;i++){r.push(b(a[i]))}return r}}};return({name:"mustache.js",version:"0.3.1-dev-twitter",to_html:function(a,b,c,d){var e=new o();if(d){e.send=d}e.render(a,b||{},c);if(!d){return e.buffer.join("\n")}}})}();